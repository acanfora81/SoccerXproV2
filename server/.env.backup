# C:\Progetti\SoccerXpro_V2\server\.env
# Configurazione completa server con Supabase Auth + Redis Logout Sicuro

# ===========================================
# üåê APPLICAZIONE
# ===========================================
NODE_ENV=development
PORT=3001
APP_NAME=SoccerXpro_V2
APP_VERSION=0.1.0

# ===========================================
# üóÑÔ∏è DATABASE
# ===========================================

# ‚úÖ CORRETTO: Era RISMA_DISABLE_PREPARED_STATEMENTS
PRISMA_DISABLE_PREPARED_STATEMENTS=true

# ‚úÖ MIGLIORATO: Aggiunto pool_timeout e connection_limit per stabilit√†
DATABASE_URL="postgresql://postgres.uzgyfbsclurezfaahmsi:Pippopazzo.9@aws-1-eu-central-1.pooler.supabase.com:6543/postgres?schema=soccerxpro&sslmode=require&pgbouncer=true&prepared_statements=false&pool_timeout=20&connection_limit=10"

# ‚úÖ CORRETTO: URL diretto per migrations (porta 5432 invece di 6543)
DIRECT_URL="postgresql://postgres.uzgyfbsclurezfaahmsi:Pippopazzo.9@aws-1-eu-central-1.pooler.supabase.com:5432/postgres?schema=soccerxpro&sslmode=require&prepared_statements=false"

# ‚úÖ MIGLIORATO: Test database con configurazione corretta
TEST_DATABASE_URL="postgresql://postgres.uzgyfbsclurezfaahmsi:Pippopazzo.9@aws-1-eu-central-1.pooler.supabase.com:6543/postgres?schema=soccerxpro_test&sslmode=require&pgbouncer=true&prepared_statements=false"

# Database connection settings
DB_HOST=aws-1-eu-central-1.pooler.supabase.com
DB_PORT=6543
DB_NAME=postgres
DB_USERNAME=postgres.uzgyfbsclurezfaahmsi
DB_PASSWORD=Pippopazzo.9

# ===========================================
# üîê SUPABASE CONFIGURATION
# ===========================================
SUPABASE_URL=https://uzgyfbsclurezfaahmsi.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV6Z3lmYnNjbHVyZXpmYWFobXNpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU3NjA2MTcsImV4cCI6MjA3MTMzNjYxN30.P90zPP1pUI5-LBHh1ulOsOtilXD9rMl8ul4zh1MFFA4
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV6Z3lmYnNjbHVyZXpmYWFobXNpIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NTc2MDYxNywiZXhwIjoyMDcxMzM2NjE3fQ.8HYOwCgUuMNuT8lUxI67b-jqt2nao7h8YqXAoGFMAxE

# ===========================================
# üî¥ REDIS CONFIGURATION - LOGOUT SICURO
# ===========================================
# Redis per token blacklist (IMPORTANTE per logout sicuro)
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis connection settings
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000
REDIS_CONNECT_TIMEOUT=5000
REDIS_COMMAND_TIMEOUT=3000

# Token blacklist settings
TOKEN_BLACKLIST_TTL=86400
TOKEN_BLACKLIST_CLEANUP_INTERVAL=300

# Cache TTL (Time To Live) in seconds
CACHE_TTL=3600

# ===========================================
# üîê AUTENTICAZIONE SICURA
# ===========================================
# JWT Secret (genera una stringa casuale sicura)
JWT_SECRET=ba772cfb4acdbf24d30c88534c8f5ed7a6c5ddc78cfc95d0d12452a40f468c05ad7e0b85eff69c012dd2e5440f67c2b27ea8f8ebe4d0c1b8e6f63fb21e483ba4
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# Session secret
SESSION_SECRET=675f2b016d254330827b82a4413815d95bc3b94d1483b28d519ff5e93c127919

# Security settings
AUTH_TOKEN_BLACKLIST_ENABLED=true
AUTH_SESSION_TIMEOUT=3600
AUTH_MAX_LOGIN_ATTEMPTS=5
AUTH_LOCKOUT_DURATION=900

# ===========================================
# üìß EMAIL (opzionale)
# ===========================================
# SMTP Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password

# Email templates
EMAIL_FROM=noreply@soccerxpro.com
EMAIL_FROM_NAME=SoccerXpro V2

# ===========================================
# üìÅ FILE STORAGE
# ===========================================
# Upload settings
UPLOAD_DIR=uploads
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=pdf,doc,docx,jpg,jpeg,png,gif

# AWS S3 (se usi cloud storage)
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=eu-west-1
AWS_S3_BUCKET=soccerxpro-uploads

# ===========================================
# üìä LOGGING & MONITORING
# ===========================================
# Log levels: error, warn, info, debug
LOG_LEVEL=debug
LOG_FILE=logs/app.log

# Enable/disable specific log types
LOG_ENABLE_API=true
LOG_ENABLE_DATABASE=true
LOG_ENABLE_AUTH=true
LOG_ENABLE_PERFORMANCE=true
LOG_ENABLE_SECURITY=true

# ===========================================
# üß™ TESTING
# ===========================================
# E2E Testing
E2E_BASE_URL=http://localhost:3000
E2E_HEADLESS=true

# Security testing
TEST_ENABLE_SECURITY_TESTS=true
TEST_LOGOUT_TIMEOUT=5000

# ===========================================
# üîß DEVELOPMENT
# ===========================================
# Hot reload
VITE_HMR=true

# API Base URL
VITE_API_BASE_URL=http://localhost:3001/api

# Enable dev tools
VITE_ENABLE_DEVTOOLS=true
VITE_ENABLE_STORYBOOK=true

# ===========================================
# üåê INTERNAZIONALIZZAZIONE
# ===========================================
DEFAULT_LANGUAGE=it
SUPPORTED_LANGUAGES=it,en,es

# ===========================================
# üìà ANALYTICS (opzionale)
# ===========================================
# Google Analytics
# GA_TRACKING_ID=GA-XXXXXXXXX

# Sentry Error Tracking
# SENTRY_DSN=https://your-sentry-dsn-here

# ===========================================
# üéØ FEATURE FLAGS
# ===========================================
# Enable/disable features
FEATURE_MARKET_MODULE=true
FEATURE_MEDICAL_MODULE=true
FEATURE_ADMINISTRATION_MODULE=true
FEATURE_ADVANCED_ANALYTICS=false
FEATURE_REAL_TIME_NOTIFICATIONS=true
FEATURE_SECURE_LOGOUT=true

# ===========================================
# üì± API RATE LIMITING
# ===========================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ===========================================
# üîí SECURITY
# ===========================================
# CORS settings
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# Content Security Policy
CSP_ENABLED=true

# Security headers
SECURITY_HSTS_ENABLED=true
SECURITY_NOSNIFF_ENABLED=true
SECURITY_FRAME_OPTIONS=DENY

# ===========================================
# üìã BUSINESS LOGIC
# ===========================================
# Contract settings
DEFAULT_CONTRACT_DURATION_YEARS=2
MAX_CONTRACT_DURATION_YEARS=5

# Medical settings  
INJURY_FOLLOWUP_DAYS=7
MEDICAL_REPORT_RETENTION_YEARS=10

# üîê Chiave master per cifratura dati medici (32B base64)
MEDICAL_MASTER_KEY=kq5LNpickqccfP8Iu9/nQLxQKJ4I+cibQ5HG/OAePek=

# Financial settings
DEFAULT_CURRENCY=EUR
BUDGET_FISCAL_YEAR_START=07-01

# ===========================================
# üîß PRISMA DATABASE SETTINGS
# ===========================================
# ‚úÖ CONFIGURAZIONI PRISMA per PgBouncer compatibility
PRISMA_CLI_QUERY_ENGINE_TYPE=binary
PRISMA_CLIENT_ENGINE_TYPE=binary

# ===========================================
# üöÄ PRODUCTION OVERRIDES
# ===========================================
# Uncomment and modify for production deployment

# NODE_ENV=production
# LOG_LEVEL=warn
# REDIS_URL=redis://your-production-redis:6379
# REDIS_PASSWORD=your-redis-password

# ‚úÖ MIGLIORATO: Production database con parametri ottimizzati
# DATABASE_URL="postgresql://postgres.uzgyfbsclurezfaahmsi:Pippopazzo.9@aws-1-eu-central-1.pooler.supabase.com:6543/postgres?schema=soccerxpro&sslmode=require&pgbouncer=true&prepared_statements=false&pool_timeout=20&connection_limit=20&idle_timeout=300"

# Production security
# JWT_EXPIRES_IN=1h
# JWT_REFRESH_EXPIRES_IN=7d
# AUTH_SESSION_TIMEOUT=1800
# RATE_LIMIT_MAX_REQUESTS=50